<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: QiniuNg::Streaming::Hub
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "QiniuNg::Streaming::Hub";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (H)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../QiniuNg.html" title="QiniuNg (module)">QiniuNg</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Streaming.html" title="QiniuNg::Streaming (module)">Streaming</a></span></span>
     &raquo; 
    <span class="title">Hub</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: QiniuNg::Streaming::Hub
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">QiniuNg::Streaming::Hub</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/qiniu_ng/streaming/hub.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>七牛直播空间</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_client'>client</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../QiniuNg.html" title="QiniuNg (module)">QiniuNg</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_client'><span class='object_link'><a href="../../QiniuNg.html#new_client-class_method" title="QiniuNg.new_client (method)">new_client</a></span></span><span class='lparen'>(</span><span class='label'>access_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;Qiniu AccessKey&gt;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>secret_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;Qiniu SecretKey&gt;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_streams'>streams</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_hub'>hub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;Hub Name&gt;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>domain:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;Hub Domain&gt;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_streams'>streams</span></code></pre>
    
  </div>


</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>直播空间名称.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_rtc_app-instance_method" title="#create_rtc_app (instance method)">#<strong>create_rtc_app</strong>(title: nil, max_users: nil, auto_kick: true, rtc_url: nil, https: nil, **options)  &#x21d2; QiniuNg::RTC::App </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>创建实时音视频直播应用.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_stream-instance_method" title="#create_stream (instance method)">#<strong>create_stream</strong>(key, pili_url: nil, https: nil, **options)  &#x21d2; Stream </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>创建直播流.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#live_info-instance_method" title="#live_info (instance method)">#<strong>live_info</strong>(*stream_keys, pili_url: nil, https: nil, **options)  &#x21d2; Hash&lt;String, Stream::LiveInfo&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>批量查询直播实时信息.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stream-instance_method" title="#stream (instance method)">#<strong>stream</strong>(key)  &#x21d2; Stream </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>获取直播流.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#streams-instance_method" title="#streams (instance method)">#<strong>streams</strong>(live_only: false, prefix: nil, pili_url: nil, limit: nil, marker: nil, https: nil, **options)  &#x21d2; Enumerable </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>列出所有直播流.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="name-instance_method">
  
    #<strong>name</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns 直播空间名称</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>直播空间名称</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/qiniu_ng/streaming/hub.rb', line 15</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="QiniuNg::Streaming::Hub (class)">Hub</a></span></span>
  <span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:name</span>
  <span class='comment'># @!visibility private
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_hub'>hub</span><span class='comma'>,</span> <span class='id identifier rubyid_http_client_v2'>http_client_v2</span><span class='comma'>,</span> <span class='id identifier rubyid_auth'>auth</span><span class='comma'>,</span> <span class='id identifier rubyid_domain'>domain</span><span class='comma'>,</span> <span class='id identifier rubyid_bucket'>bucket</span><span class='rparen'>)</span>
    <span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_hub'>hub</span>
    <span class='ivar'>@auth</span> <span class='op'>=</span> <span class='id identifier rubyid_auth'>auth</span>
    <span class='ivar'>@http_client_v2</span> <span class='op'>=</span> <span class='id identifier rubyid_http_client_v2'>http_client_v2</span>
    <span class='ivar'>@domain</span> <span class='op'>=</span> <span class='id identifier rubyid_domain'>domain</span>
    <span class='ivar'>@bucket</span> <span class='op'>=</span> <span class='id identifier rubyid_bucket'>bucket</span>
  <span class='kw'>end</span>

  <span class='comment'># 创建实时音视频直播应用
</span>  <span class='comment'>#
</span>  <span class='comment'># @param [String] title RTC 应用名称
</span>  <span class='comment'># @param [Integer] max_users 连麦房间支持的最大在线人数
</span>  <span class='comment'># @param [Boolean] auto_kick 是否启用自动踢人。
</span>  <span class='comment'>#   表示同一个身份的客户端，一旦新的连麦请求可以成功，旧连接将被关闭
</span>  <span class='comment'># @param [String] rtc_url RTC 所在服务器地址，一般无需填写
</span>  <span class='comment'># @param [Boolean] https 是否使用 HTTPS 协议
</span>  <span class='comment'># @param [Hash] options 额外的 Faraday 参数
</span>  <span class='comment'># @raise [QiniuNg::HTTP::HubNotMatch] 应用和直播空间不匹配
</span>  <span class='comment'># @return [QiniuNg::RTC::App] 返回 RTC 应用
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_rtc_app'>create_rtc_app</span><span class='lparen'>(</span><span class='label'>title:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>max_users:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>auto_kick:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>rtc_url:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>https:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_req_body'>req_body</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>hub:</span> <span class='ivar'>@name</span><span class='comma'>,</span> <span class='label'>title:</span> <span class='id identifier rubyid_title'>title</span><span class='comma'>,</span> <span class='label'>maxUsers:</span> <span class='id identifier rubyid_max_users'>max_users</span><span class='comma'>,</span> <span class='label'>noAutoKickUser:</span> <span class='op'>!</span><span class='id identifier rubyid_auto_kick'>auto_kick</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>
    <span class='id identifier rubyid_resp_body'>resp_body</span> <span class='op'>=</span> <span class='ivar'>@http_client_v2</span><span class='period'>.</span><span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/v3/apps</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_rtc_url'>rtc_url</span> <span class='op'>||</span> <span class='id identifier rubyid_get_rtc_url'>get_rtc_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span><span class='comma'>,</span>
                                     <span class='label'>headers:</span> <span class='lbrace'>{</span> <span class='label'>content_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/json</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
                                     <span class='label'>body:</span> <span class='const'><span class='object_link'><a href="../Config.html" title="QiniuNg::Config (class)">Config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_default_json_marshaler'><span class='object_link'><a href="../Config.html#default_json_marshaler-class_method" title="QiniuNg::Config.default_json_marshaler (method)">default_json_marshaler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_req_body'>req_body</span><span class='rparen'>)</span><span class='comma'>,</span>
                                     <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span>
    <span class='const'><span class='object_link'><a href="../RTC.html" title="QiniuNg::RTC (module)">RTC</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../RTC/App.html" title="QiniuNg::RTC::App (class)">App</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_resp_body'>resp_body</span><span class='comma'>,</span> <span class='ivar'>@http_client_v2</span><span class='comma'>,</span> <span class='ivar'>@auth</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># 获取直播流
</span>  <span class='comment'>#
</span>  <span class='comment'># @param [String] key 直播流名称
</span>  <span class='comment'># @return [Stream] 返回直播流
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_stream'>stream</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="Stream.html" title="QiniuNg::Streaming::Stream (class)">Stream</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='ivar'>@http_client_v2</span><span class='comma'>,</span> <span class='ivar'>@auth</span><span class='comma'>,</span> <span class='ivar'>@domain</span><span class='comma'>,</span> <span class='ivar'>@bucket</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># 创建直播流
</span>  <span class='comment'>#
</span>  <span class='comment'># @param [String] key 直播流名称
</span>  <span class='comment'># @raise [QiniuNg::HTTP::ResourceExists] 直播流已经存在
</span>  <span class='comment'># @return [Stream] 返回直播流
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_create_stream'>create_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='label'>pili_url:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>https:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='ivar'>@http_client_v2</span><span class='period'>.</span><span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/v2/hubs/</span><span class='embexpr_beg'>#{</span><span class='ivar'>@name</span><span class='embexpr_end'>}</span><span class='tstring_content'>/streams</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_pili_url'>pili_url</span> <span class='op'>||</span> <span class='id identifier rubyid_get_pili_url'>get_pili_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span><span class='comma'>,</span>
                         <span class='label'>headers:</span> <span class='lbrace'>{</span> <span class='label'>content_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/json</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
                         <span class='label'>body:</span> <span class='const'><span class='object_link'><a href="../Config.html" title="QiniuNg::Config (class)">Config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_default_json_marshaler'><span class='object_link'><a href="../Config.html#default_json_marshaler-class_method" title="QiniuNg::Config.default_json_marshaler (method)">default_json_marshaler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='label'>key:</span> <span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span><span class='comma'>,</span>
                         <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_stream'>stream</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># 批量查询直播实时信息
</span>  <span class='comment'>#
</span>  <span class='comment'># @param [Array&lt;String&gt;] stream_keys 提供需要查询的直播流
</span>  <span class='comment'># @return [Hash&lt;String, Stream::LiveInfo&gt;] 返回直播流实时信息，Key 为直播流名称，Value 为直播流实时信息。
</span>  <span class='comment'>#   并非所有在 stream_keys 中的直播流都会返回在结果中，如果该直播流当时没有处于直播状态，则不会返回
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_live_info'>live_info</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_stream_keys'>stream_keys</span><span class='comma'>,</span> <span class='label'>pili_url:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>https:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_stream_keys'>stream_keys</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/v2/hubs/</span><span class='embexpr_beg'>#{</span><span class='ivar'>@name</span><span class='embexpr_end'>}</span><span class='tstring_content'>/livestreams</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_resp_body'>resp_body</span> <span class='op'>=</span> <span class='ivar'>@http_client_v2</span><span class='period'>.</span><span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_pili_url'>pili_url</span> <span class='op'>||</span> <span class='id identifier rubyid_get_pili_url'>get_pili_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span><span class='comma'>,</span>
                                     <span class='label'>headers:</span> <span class='lbrace'>{</span> <span class='label'>content_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/json</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
                                     <span class='label'>body:</span> <span class='const'><span class='object_link'><a href="../Config.html" title="QiniuNg::Config (class)">Config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_default_json_marshaler'><span class='object_link'><a href="../Config.html#default_json_marshaler-class_method" title="QiniuNg::Config.default_json_marshaler (method)">default_json_marshaler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='label'>items:</span> <span class='id identifier rubyid_stream_keys'>stream_keys</span><span class='rparen'>)</span><span class='comma'>,</span>
                                     <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span>
    <span class='id identifier rubyid_resp_body'>resp_body</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='comma'>,</span> <span class='id identifier rubyid_hash'>hash</span><span class='op'>|</span>
      <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_item'>item</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Stream.html" title="QiniuNg::Streaming::Stream (class)">Stream</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Stream/LiveInfo.html" title="QiniuNg::Streaming::Stream::LiveInfo (class)">LiveInfo</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
  <span class='kw'>end</span>

  <span class='comment'># 列出所有直播流
</span>  <span class='comment'>#
</span>  <span class='comment'># @example
</span>  <span class='comment'>#   client = QiniuNg.new_client(access_key: &#39;&lt;Qiniu AccessKey&gt;&#39;, secret_key: &#39;&lt;Qiniu SecretKey&gt;&#39;)
</span>  <span class='comment'>#   streams = client.hub(&#39;&lt;Hub Name&gt;&#39;, domain: &#39;&lt;Hub Domain&gt;&#39;).streams
</span>  <span class='comment'>#
</span>  <span class='comment'># @param [Boolean] live_only 是否正处于直播状态
</span>  <span class='comment'># @param [String] prefix 匹配直播流前缀
</span>  <span class='comment'># @param [String] pili_url Pili 所在服务器地址，一般无需填写
</span>  <span class='comment'># @param [Boolean] https 是否使用 HTTPS 协议
</span>  <span class='comment'># @param [Hash] options 额外的 Faraday 参数
</span>  <span class='comment'># @return [Enumerable] 返回一个{迭代器}[https://ruby-doc.org/core-2.6/Enumerable.html]实例
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_streams'>streams</span><span class='lparen'>(</span><span class='label'>live_only:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>pili_url:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>limit:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>marker:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>https:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='const'>StreamsIterator</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='ivar'>@http_client_v2</span><span class='comma'>,</span> <span class='id identifier rubyid_live_only'>live_only</span><span class='comma'>,</span> <span class='id identifier rubyid_prefix'>prefix</span><span class='comma'>,</span> <span class='id identifier rubyid_limit'>limit</span><span class='comma'>,</span> <span class='id identifier rubyid_marker'>marker</span><span class='comma'>,</span> <span class='id identifier rubyid_pili_url'>pili_url</span><span class='comma'>,</span> <span class='id identifier rubyid_https'>https</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># @!visibility private
</span>  <span class='kw'>class</span> <span class='const'>StreamsIterator</span>
    <span class='id identifier rubyid_include'>include</span> <span class='const'>Enumerable</span>
    <span class='id identifier rubyid_extend'>extend</span> <span class='const'>Forwardable</span>

    <span class='comment'># @!visibility private
</span>    <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_hub'>hub</span><span class='comma'>,</span> <span class='id identifier rubyid_http_client_v2'>http_client_v2</span><span class='comma'>,</span> <span class='id identifier rubyid_live_only'>live_only</span><span class='comma'>,</span> <span class='id identifier rubyid_prefix'>prefix</span><span class='comma'>,</span> <span class='id identifier rubyid_limit'>limit</span><span class='comma'>,</span> <span class='id identifier rubyid_marker'>marker</span><span class='comma'>,</span> <span class='id identifier rubyid_pili_url'>pili_url</span><span class='comma'>,</span> <span class='id identifier rubyid_https'>https</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
      <span class='ivar'>@hub</span> <span class='op'>=</span> <span class='id identifier rubyid_hub'>hub</span>
      <span class='ivar'>@http_client_v2</span> <span class='op'>=</span> <span class='id identifier rubyid_http_client_v2'>http_client_v2</span>
      <span class='ivar'>@live_only</span> <span class='op'>=</span> <span class='id identifier rubyid_live_only'>live_only</span>
      <span class='ivar'>@prefix</span> <span class='op'>=</span> <span class='id identifier rubyid_prefix'>prefix</span>
      <span class='ivar'>@limit</span> <span class='op'>=</span> <span class='id identifier rubyid_limit'>limit</span>
      <span class='ivar'>@marker</span> <span class='op'>=</span> <span class='id identifier rubyid_marker'>marker</span>
      <span class='ivar'>@pili_url</span> <span class='op'>=</span> <span class='id identifier rubyid_pili_url'>pili_url</span> <span class='op'>||</span> <span class='id identifier rubyid_get_pili_url'>get_pili_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span>
      <span class='ivar'>@got</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='ivar'>@options</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_def_delegators'>def_delegators</span> <span class='symbol'>:enumerator</span><span class='comma'>,</span> <span class='symbol'>:each</span>

    <span class='id identifier rubyid_private'>private</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_enumerator'>enumerator</span>
      <span class='const'>Enumerator</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_yielder'>yielder</span><span class='op'>|</span>
        <span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
          <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
          <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:liveonly</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>true</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='ivar'>@live_only</span>
          <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:prefix</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@prefix</span> <span class='kw'>unless</span> <span class='ivar'>@prefix</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='ivar'>@prefix</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
          <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:limit</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@limit</span> <span class='kw'>unless</span> <span class='ivar'>@limit</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='op'>!</span><span class='ivar'>@limit</span><span class='period'>.</span><span class='id identifier rubyid_positive?'>positive?</span>
          <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:marker</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@marker</span> <span class='kw'>unless</span> <span class='ivar'>@marker</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='ivar'>@marker</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
          <span class='id identifier rubyid_body'>body</span> <span class='op'>=</span> <span class='ivar'>@http_client_v2</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/v2/hubs/</span><span class='embexpr_beg'>#{</span><span class='ivar'>@hub</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>/streams</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@pili_url</span><span class='comma'>,</span>
                                     <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='comma'>,</span> <span class='op'>**</span><span class='ivar'>@options</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span>
          <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='period'>.</span><span class='id identifier rubyid_zero?'>zero?</span>

          <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span>
            <span class='kw'>break</span> <span class='kw'>unless</span> <span class='ivar'>@limit</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='ivar'>@got</span> <span class='op'>&lt;</span> <span class='ivar'>@limit</span>

            <span class='id identifier rubyid_yielder'>yielder</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@hub</span><span class='period'>.</span><span class='id identifier rubyid_stream'>stream</span><span class='lparen'>(</span><span class='id identifier rubyid_item'>item</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
            <span class='ivar'>@got</span> <span class='op'>+=</span> <span class='int'>1</span>
          <span class='kw'>end</span>
          <span class='ivar'>@marker</span> <span class='op'>=</span> <span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>marker</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
          <span class='kw'>break</span> <span class='kw'>if</span> <span class='ivar'>@marker</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='ivar'>@marker</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='op'>!</span><span class='ivar'>@limit</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@got</span> <span class='op'>&gt;=</span> <span class='ivar'>@limit</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_get_pili_url'>get_pili_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span>
      <span class='const'><span class='object_link'><a href="../Common.html" title="QiniuNg::Common (module)">Common</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Common/Zone.html" title="QiniuNg::Common::Zone (class)">Zone</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pili_url'>pili_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># @!visibility private
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> @name=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_private'>private</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_pili_url'>get_pili_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="../Common.html" title="QiniuNg::Common (module)">Common</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Common/Zone.html" title="QiniuNg::Common::Zone (class)">Zone</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pili_url'>pili_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_get_rtc_url'>get_rtc_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="../Common.html" title="QiniuNg::Common (module)">Common</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Common/Zone.html" title="QiniuNg::Common::Zone (class)">Zone</a></span></span><span class='period'>.</span><span class='id identifier rubyid_rtc_url'>rtc_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create_rtc_app-instance_method">
  
    #<strong>create_rtc_app</strong>(title: nil, max_users: nil, auto_kick: true, rtc_url: nil, https: nil, **options)  &#x21d2; <tt><span class='object_link'><a href="../RTC/App.html" title="QiniuNg::RTC::App (class)">QiniuNg::RTC::App</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>创建实时音视频直播应用</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>title</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>RTC 应用名称</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_users</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>连麦房间支持的最大在线人数</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>auto_kick</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>是否启用自动踢人。 表示同一个身份的客户端，一旦新的连麦请求可以成功，旧连接将被关闭</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>rtc_url</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>RTC 所在服务器地址，一般无需填写</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>https</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>是否使用 HTTPS 协议</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>额外的 Faraday 参数</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../RTC/App.html" title="QiniuNg::RTC::App (class)">QiniuNg::RTC::App</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>返回 RTC 应用</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../HTTP/HubNotMatch.html" title="QiniuNg::HTTP::HubNotMatch (class)">QiniuNg::HTTP::HubNotMatch</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>应用和直播空间不匹配</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39
40
41
42
43
44</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/qiniu_ng/streaming/hub.rb', line 37</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_rtc_app'>create_rtc_app</span><span class='lparen'>(</span><span class='label'>title:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>max_users:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>auto_kick:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>rtc_url:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>https:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_req_body'>req_body</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>hub:</span> <span class='ivar'>@name</span><span class='comma'>,</span> <span class='label'>title:</span> <span class='id identifier rubyid_title'>title</span><span class='comma'>,</span> <span class='label'>maxUsers:</span> <span class='id identifier rubyid_max_users'>max_users</span><span class='comma'>,</span> <span class='label'>noAutoKickUser:</span> <span class='op'>!</span><span class='id identifier rubyid_auto_kick'>auto_kick</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>
  <span class='id identifier rubyid_resp_body'>resp_body</span> <span class='op'>=</span> <span class='ivar'>@http_client_v2</span><span class='period'>.</span><span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/v3/apps</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_rtc_url'>rtc_url</span> <span class='op'>||</span> <span class='id identifier rubyid_get_rtc_url'>get_rtc_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span><span class='comma'>,</span>
                                   <span class='label'>headers:</span> <span class='lbrace'>{</span> <span class='label'>content_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/json</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
                                   <span class='label'>body:</span> <span class='const'><span class='object_link'><a href="../Config.html" title="QiniuNg::Config (class)">Config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_default_json_marshaler'><span class='object_link'><a href="../Config.html#default_json_marshaler-class_method" title="QiniuNg::Config.default_json_marshaler (method)">default_json_marshaler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_req_body'>req_body</span><span class='rparen'>)</span><span class='comma'>,</span>
                                   <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span>
  <span class='const'><span class='object_link'><a href="../RTC.html" title="QiniuNg::RTC (module)">RTC</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../RTC/App.html" title="QiniuNg::RTC::App (class)">App</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_resp_body'>resp_body</span><span class='comma'>,</span> <span class='ivar'>@http_client_v2</span><span class='comma'>,</span> <span class='ivar'>@auth</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_stream-instance_method">
  
    #<strong>create_stream</strong>(key, pili_url: nil, https: nil, **options)  &#x21d2; <tt><span class='object_link'><a href="Stream.html" title="QiniuNg::Streaming::Stream (class)">Stream</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>创建直播流</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>直播流名称</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Stream.html" title="QiniuNg::Streaming::Stream (class)">Stream</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>返回直播流</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../HTTP/ResourceExists.html" title="QiniuNg::HTTP::ResourceExists (class)">QiniuNg::HTTP::ResourceExists</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>直播流已经存在</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/qiniu_ng/streaming/hub.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_stream'>create_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='label'>pili_url:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>https:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='ivar'>@http_client_v2</span><span class='period'>.</span><span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/v2/hubs/</span><span class='embexpr_beg'>#{</span><span class='ivar'>@name</span><span class='embexpr_end'>}</span><span class='tstring_content'>/streams</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_pili_url'>pili_url</span> <span class='op'>||</span> <span class='id identifier rubyid_get_pili_url'>get_pili_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span><span class='comma'>,</span>
                       <span class='label'>headers:</span> <span class='lbrace'>{</span> <span class='label'>content_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/json</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
                       <span class='label'>body:</span> <span class='const'><span class='object_link'><a href="../Config.html" title="QiniuNg::Config (class)">Config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_default_json_marshaler'><span class='object_link'><a href="../Config.html#default_json_marshaler-class_method" title="QiniuNg::Config.default_json_marshaler (method)">default_json_marshaler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='label'>key:</span> <span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span><span class='comma'>,</span>
                       <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_stream'>stream</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="live_info-instance_method">
  
    #<strong>live_info</strong>(*stream_keys, pili_url: nil, https: nil, **options)  &#x21d2; <tt>Hash&lt;String, <span class='object_link'><a href="Stream/LiveInfo.html" title="QiniuNg::Streaming::Stream::LiveInfo (class)">Stream::LiveInfo</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>批量查询直播实时信息</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>stream_keys</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>提供需要查询的直播流</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash&lt;String, <span class='object_link'><a href="Stream/LiveInfo.html" title="QiniuNg::Streaming::Stream::LiveInfo (class)">Stream::LiveInfo</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>返回直播流实时信息，Key 为直播流名称，Value 为直播流实时信息。 并非所有在 stream_keys 中的直播流都会返回在结果中，如果该直播流当时没有处于直播状态，则不会返回</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74
75
76
77
78
79
80
81
82
83</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/qiniu_ng/streaming/hub.rb', line 72</span>

<span class='kw'>def</span> <span class='id identifier rubyid_live_info'>live_info</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_stream_keys'>stream_keys</span><span class='comma'>,</span> <span class='label'>pili_url:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>https:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_stream_keys'>stream_keys</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/v2/hubs/</span><span class='embexpr_beg'>#{</span><span class='ivar'>@name</span><span class='embexpr_end'>}</span><span class='tstring_content'>/livestreams</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_resp_body'>resp_body</span> <span class='op'>=</span> <span class='ivar'>@http_client_v2</span><span class='period'>.</span><span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_pili_url'>pili_url</span> <span class='op'>||</span> <span class='id identifier rubyid_get_pili_url'>get_pili_url</span><span class='lparen'>(</span><span class='id identifier rubyid_https'>https</span><span class='rparen'>)</span><span class='comma'>,</span>
                                   <span class='label'>headers:</span> <span class='lbrace'>{</span> <span class='label'>content_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/json</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
                                   <span class='label'>body:</span> <span class='const'><span class='object_link'><a href="../Config.html" title="QiniuNg::Config (class)">Config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_default_json_marshaler'><span class='object_link'><a href="../Config.html#default_json_marshaler-class_method" title="QiniuNg::Config.default_json_marshaler (method)">default_json_marshaler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='label'>items:</span> <span class='id identifier rubyid_stream_keys'>stream_keys</span><span class='rparen'>)</span><span class='comma'>,</span>
                                   <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span>
  <span class='id identifier rubyid_resp_body'>resp_body</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='comma'>,</span> <span class='id identifier rubyid_hash'>hash</span><span class='op'>|</span>
    <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_item'>item</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Stream.html" title="QiniuNg::Streaming::Stream (class)">Stream</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Stream/LiveInfo.html" title="QiniuNg::Streaming::Stream::LiveInfo (class)">LiveInfo</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stream-instance_method">
  
    #<strong>stream</strong>(key)  &#x21d2; <tt><span class='object_link'><a href="Stream.html" title="QiniuNg::Streaming::Stream (class)">Stream</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>获取直播流</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>直播流名称</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Stream.html" title="QiniuNg::Streaming::Stream (class)">Stream</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>返回直播流</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/qiniu_ng/streaming/hub.rb', line 50</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stream'>stream</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Stream.html" title="QiniuNg::Streaming::Stream (class)">Stream</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='ivar'>@http_client_v2</span><span class='comma'>,</span> <span class='ivar'>@auth</span><span class='comma'>,</span> <span class='ivar'>@domain</span><span class='comma'>,</span> <span class='ivar'>@bucket</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="streams-instance_method">
  
    #<strong>streams</strong>(live_only: false, prefix: nil, pili_url: nil, limit: nil, marker: nil, https: nil, **options)  &#x21d2; <tt>Enumerable</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>列出所有直播流</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_client'>client</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../QiniuNg.html" title="QiniuNg (module)">QiniuNg</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_client'><span class='object_link'><a href="../../QiniuNg.html#new_client-class_method" title="QiniuNg.new_client (method)">new_client</a></span></span><span class='lparen'>(</span><span class='label'>access_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;Qiniu AccessKey&gt;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>secret_key:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;Qiniu SecretKey&gt;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_streams'>streams</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_hub'>hub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;Hub Name&gt;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>domain:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;Hub Domain&gt;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_streams'>streams</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>live_only</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>是否正处于直播状态</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>prefix</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>匹配直播流前缀</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>pili_url</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Pili 所在服务器地址，一般无需填写</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>https</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>是否使用 HTTPS 协议</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>额外的 Faraday 参数</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Enumerable</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>返回一个<a href="https://ruby-doc.org/core-2.6/Enumerable.html">迭代器</a>实例</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/qiniu_ng/streaming/hub.rb', line 97</span>

<span class='kw'>def</span> <span class='id identifier rubyid_streams'>streams</span><span class='lparen'>(</span><span class='label'>live_only:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>prefix:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>pili_url:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>limit:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>marker:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>https:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='const'>StreamsIterator</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='ivar'>@http_client_v2</span><span class='comma'>,</span> <span class='id identifier rubyid_live_only'>live_only</span><span class='comma'>,</span> <span class='id identifier rubyid_prefix'>prefix</span><span class='comma'>,</span> <span class='id identifier rubyid_limit'>limit</span><span class='comma'>,</span> <span class='id identifier rubyid_marker'>marker</span><span class='comma'>,</span> <span class='id identifier rubyid_pili_url'>pili_url</span><span class='comma'>,</span> <span class='id identifier rubyid_https'>https</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Aug  5 09:12:40 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20 (ruby-2.6.1).
</div>

    </div>
  </body>
</html>